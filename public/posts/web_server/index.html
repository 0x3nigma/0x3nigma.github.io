<!DOCTYPE html>
<html lang="en-us">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>
Building a Web Server from Scratch in Python | 0x3nigma
</title>

    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Your website description">

<meta name="generator" content="Hugo 0.151.0">


<link rel="canonical" href="http://localhost:1313/posts/web_server/" >




<link href="/css/style.min.66302fa6c122ab7804faa4bd6465554ac4d746c25294af622826d0445b79ab94.css" rel="stylesheet">




</head>

<body>

    <div class="flexWrapper">
        <header class="headerWrapper">
    <div class="header">
        <div>
            <a class="terminal" href="/">
                <span>0x3nigma@localhost ~ $</span>
            </a>
        </div>
        <input class="side-menu" type="checkbox" id="side-menu">
        <label class="hamb" for="side-menu"><span class="hamb-line"></span></label>
        <nav class="headerLinks">
            <ul>
                
                <li>
                    <a href="http://localhost:1313/posts/" title="" >
                        ~/posts</a>
                </li>
                
                <li>
                    <a href="http://localhost:1313/about/" title="" >
                        ~/about</a>
                </li>
                
                <li>
                    <a href="http://localhost:1313/categories/" title="" >
                        ~/categories</a>
                </li>
                
            </ul>
        </nav>
    </div>
</header>


        <div class="content">
            <main class="main">
                
<div class="postWrapper">
    <h1>Building a Web Server from Scratch in Python</h1>
    

    
    
    
    

    
    
    
    
    

    
    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    <section class="postMetadata">
        <dl>
            
            
            
                
<dt>categories</dt>
<dd><span></span>
    <a href="/categories/python/">Python</a><span></span>
    <a href="/categories/web-server/">Web Server</a></dd>
            
            
                <dt>published</dt>
                 
                 
                 <dd><time datetime="2025-10-20">2025-10-20</time></dd>
            
            
                <dt>reading time</dt>
                <dd>7 minutes</dd>
            
        </dl>
    </section>
    
    <div>
        <p>I am trying to learn how a web server like nginx work. So I thought of making one myself because the best way to learn something is making it yourself. This will be a multipart series.
In this first part, we&rsquo;ll build a simple, single-threaded server that can handle basic HTTP requests and even has a custom echo endpoint.</p>
<h2 id="creating-the-server">Creating the server</h2>
<h4 id="step-1">Step 1:</h4>
<p>We will first create a class in python and name it Server. This Server class will contain all the functionalities of our server.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> socket
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Server</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self, ip:str, port:int, addr<span style="color:#f92672">=</span>socket<span style="color:#f92672">.</span>AF_INET, proto<span style="color:#f92672">=</span>socket<span style="color:#f92672">.</span>SOCK_STREAM):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>addr <span style="color:#f92672">=</span> addr
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>proto <span style="color:#f92672">=</span> proto
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>IP <span style="color:#f92672">=</span> ip
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>PORT <span style="color:#f92672">=</span> port
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>server <span style="color:#f92672">=</span> socket<span style="color:#f92672">.</span>socket(self<span style="color:#f92672">.</span>addr, self<span style="color:#f92672">.</span>proto)
</span></span></code></pre></div><p>We will be using the socket library provided by python.
<strong>Sockets</strong>: Sockets are endpoints of a network connection. It resides in the layer 4 or the transport layer of an OSI model. We can define a socket using a tuple of 4 elements which are :
(local_ip, local_port, remote_ip, remote_port)</p>
<ol>
<li>local_ip -&gt; Server&rsquo;s ip address</li>
<li>local_port -&gt; Server&rsquo;s port</li>
<li>remote_ip -&gt; Client&rsquo;s ip address</li>
<li>remote_port -&gt; Client&rsquo;s port</li>
</ol>
<p>In the above code we are creating a listening socket using <code>socket.socket()</code> and passing the parameters <code>socket.AF_INET</code> and <code>socket.SOCK_STREAM</code> . <code>socket.AF_INET</code> tells the OS that this socket will be using the IPv4 addressing scheme and <code>socket.SOCK_STREAM</code> tells the os that we will be using the TCP protocol. If you want to use the UDP protocol then you can replace <code>socket.SOCK_STREAM</code> with <code>socket.SOCK_DGRAM</code>.</p>
<h4 id="step-2">Step 2:</h4>
<p>Now we will create a method to start the server:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">start_server</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">with</span> self<span style="color:#f92672">.</span>server:
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>server<span style="color:#f92672">.</span>bind((self<span style="color:#f92672">.</span>IP, self<span style="color:#f92672">.</span>PORT))
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>server<span style="color:#f92672">.</span>listen()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>                    conn, addr <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>server<span style="color:#f92672">.</span>accept()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Server could not be started </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><p>We will first bind the above socket to an IP and PORT using <code>self.server.bind((self.IP, self.PORT))</code> . Then we will call the <code>listen()</code> function which will listen for incoming client connections and store them in a  backlog queue. When this queue fills up the OS will drop any further new connections. We can set the limit to how many pending request that can be handled by passing the number to the listen function i.e. <code>listen(5)</code>.</p>
<p>Here&rsquo;s what happens under the hood:</p>
<ol>
<li>Client sends a SYN packet to our server</li>
<li>Kernel sees your socket is in LISTEN state and replies with a SYN-ACK message.</li>
<li>Client replies ACK</li>
<li>TCP connection is now established, and it goes into the accept queue.</li>
<li>Then we will call <code>accept()</code> . Then server will give the first pending connction from that queue.
The accept method will return a new established socket and store it in the <code>conn</code> variable and the address of the client in the <code>addr</code> variable.
We will be using this established socket for communications with the client.</li>
</ol>
<h4 id="step-3">Step 3:</h4>
<p>Now we will add a method for creating the http responses that our server will be sending:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_http_response</span>(self, msg):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        msg = {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            status: int,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            status_info: str, 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            headers: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            body: str
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        status <span style="color:#f92672">=</span> msg[<span style="color:#e6db74">&#39;status&#39;</span>]
</span></span><span style="display:flex;"><span>        status_info <span style="color:#f92672">=</span> msg[<span style="color:#e6db74">&#39;status_info&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">+=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;HTTP/1.1 </span><span style="color:#e6db74">{</span>status<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">{</span>status_info<span style="color:#e6db74">}</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> header <span style="color:#f92672">in</span> msg[<span style="color:#e6db74">&#39;headers&#39;</span>]<span style="color:#f92672">.</span>keys():
</span></span><span style="display:flex;"><span>            response <span style="color:#f92672">+=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>header<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>msg[<span style="color:#e6db74">&#39;headers&#39;</span>][header]<span style="color:#e6db74">}</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Blank line between header and body </span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">+=</span> msg[<span style="color:#e6db74">&#39;body&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> response
</span></span></code></pre></div><p>A HTTP response consists of a response line, headers and body , each separated by a CRLF(Carriage Return Line Feed) i.e <code>\r\n</code>.</p>
<h4 id="step-4">Step 4:</h4>
<p>Now we will create a method to add endpoints to a dictionary named <code>endpoints</code>.
So our constructor would look like :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self, ip:str, port:int, addr<span style="color:#f92672">=</span>socket<span style="color:#f92672">.</span>AF_INET, proto<span style="color:#f92672">=</span>socket<span style="color:#f92672">.</span>SOCK_STREAM):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>addr <span style="color:#f92672">=</span> addr
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>proto <span style="color:#f92672">=</span> proto
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>IP <span style="color:#f92672">=</span> ip
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>PORT <span style="color:#f92672">=</span> port
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>endpoints <span style="color:#f92672">=</span> {} <span style="color:#75715e"># Added</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>server <span style="color:#f92672">=</span> socket<span style="color:#f92672">.</span>socket(self<span style="color:#f92672">.</span>addr, self<span style="color:#f92672">.</span>proto)
</span></span></code></pre></div><p>The method for adding the endpoints:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_endpoint</span>(self, path, method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;GET&#34;</span>, handler<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        key <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>method<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">{</span>path<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#75715e"># To match like : GET /index.html ...</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>endpoints[key] <span style="color:#f92672">=</span> handler
</span></span></code></pre></div><h4 id="step-5">Step 5:</h4>
<p>We will now add a method for handling the clients.</p>
<p>First we will iterate and get all the incoming data until we find <code>\r\n\r\n</code> since that is the indication that the header section is finished.
Then we will read the header <code>Content-Length</code> to get the size of the body section and we will check how much of it is already recieved.Then we will get the rest of the body.</p>
<p>It will then check the incoming request against all registered endpoints. If it finds a match, it calls the handler, sends the response, and breaks out of the loop. If the loop finishes without finding any matches, it then sends a single 404 Not Found response.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">handle_client</span>(self, conn):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Read headers first</span>
</span></span><span style="display:flex;"><span>            data <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n\r\n</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> data:
</span></span><span style="display:flex;"><span>                chunk <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> chunk:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>                data <span style="color:#f92672">+=</span> chunk
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> data:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Split headers and potential body</span>
</span></span><span style="display:flex;"><span>            headers_end <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>find(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n\r\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            headers_part <span style="color:#f92672">=</span> data[:headers_end]
</span></span><span style="display:flex;"><span>            body_data <span style="color:#f92672">=</span> data[headers_end <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>:]
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Parse headers to get Content-Length if present</span>
</span></span><span style="display:flex;"><span>            headers <span style="color:#f92672">=</span> headers_part<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>            content_length <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> header <span style="color:#f92672">in</span> headers:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> header<span style="color:#f92672">.</span>lower()<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#39;content-length:&#39;</span>):
</span></span><span style="display:flex;"><span>                    content_length <span style="color:#f92672">=</span> int(header<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;:&#39;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>strip())
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Read remaining body data if Content-Length is specified</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> len(body_data) <span style="color:#f92672">&lt;</span> content_length:
</span></span><span style="display:flex;"><span>                chunk <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> chunk:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>                body_data <span style="color:#f92672">+=</span> chunk
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Reconstruct full request</span>
</span></span><span style="display:flex;"><span>            full_request <span style="color:#f92672">=</span> headers_part <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n\r\n</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span> body_data
</span></span><span style="display:flex;"><span>            request <span style="color:#f92672">=</span> full_request<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            response_sent <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> endpoint_key, handler <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>endpoints<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> request<span style="color:#f92672">.</span>startswith(endpoint_key):
</span></span><span style="display:flex;"><span>                    response <span style="color:#f92672">=</span> handler(request)
</span></span><span style="display:flex;"><span>                    conn<span style="color:#f92672">.</span>send(self<span style="color:#f92672">.</span>create_http_response(response)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>                    response_sent <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> response_sent:
</span></span><span style="display:flex;"><span>                response <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;status&#34;</span>: <span style="color:#ae81ff">404</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;status_info&#34;</span>: <span style="color:#e6db74">&#34;Not Found&#34;</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;headers&#34;</span>: {<span style="color:#e6db74">&#39;Content-Type&#39;</span>: <span style="color:#e6db74">&#39;text/plain&#39;</span>, <span style="color:#e6db74">&#39;Content-Length&#39;</span>: <span style="color:#e6db74">&#39;9&#39;</span>},
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;body&#34;</span>: <span style="color:#e6db74">&#34;Not Found&#34;</span>
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                conn<span style="color:#f92672">.</span>send(self<span style="color:#f92672">.</span>create_http_response(response)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Error handling client: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                error_response <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;status&#34;</span>: <span style="color:#ae81ff">500</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;status_info&#34;</span>: <span style="color:#e6db74">&#34;Internal Server Error&#34;</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;headers&#34;</span>: {<span style="color:#e6db74">&#39;Content-Type&#39;</span>: <span style="color:#e6db74">&#39;text/plain&#39;</span>, <span style="color:#e6db74">&#39;Content-Length&#39;</span>: <span style="color:#e6db74">&#39;21&#39;</span>},
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;body&#34;</span>: <span style="color:#e6db74">&#34;Internal Server Error&#34;</span>
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                conn<span style="color:#f92672">.</span>send(self<span style="color:#f92672">.</span>create_http_response(error_response)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">pass</span>
</span></span></code></pre></div><p>And then add this function to the <code>start_server()</code> function to handle the clients: We will put it inside a <code>While True</code> loop such that our server doesnot close after handling only a single connection and accepts new connections from the queue.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">start_server</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">with</span> self<span style="color:#f92672">.</span>server:
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>server<span style="color:#f92672">.</span>bind((self<span style="color:#f92672">.</span>IP, self<span style="color:#f92672">.</span>PORT))
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>server<span style="color:#f92672">.</span>listen()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>                    conn, addr <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>server<span style="color:#f92672">.</span>accept()
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">with</span> conn:
</span></span><span style="display:flex;"><span>                        self<span style="color:#f92672">.</span>handle_client(conn)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Server could not be started </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h4 id="step-6">Step 6:</h4>
<p>Now we will add a very simple echo endpoint to our server that will echo back anything it receives on the path /echo/.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">echoHandler</span>(request):
</span></span><span style="display:flex;"><span>    echo_str <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34; &#34;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">2</span>] <span style="color:#75715e"># Note: This is a naive parsing method for demonstration. A real server would use a more robust parser.</span>
</span></span><span style="display:flex;"><span>    msg <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;status&#34;</span>: <span style="color:#ae81ff">200</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;status_info&#34;</span>: <span style="color:#e6db74">&#34;OK&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;headers&#34;</span>: {<span style="color:#e6db74">&#39;Content-Length&#39;</span>: str(len(echo_str)), <span style="color:#e6db74">&#39;Content-Type&#39;</span>: <span style="color:#e6db74">&#34;text/plain&#34;</span>},
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;body&#34;</span>: echo_str
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> msg
</span></span></code></pre></div><p>Here we do a bit of string manipulation to get the string from the path /echo/x and then send a response containing the string <code>x</code>.</p>
<p>Hence we have created a simple HTTP server using python that supports endpoints. We have tried to make it as modular as possible . Here is the complete code</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> socket
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Server</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self, ip:str, port:int, addr<span style="color:#f92672">=</span>socket<span style="color:#f92672">.</span>AF_INET, proto<span style="color:#f92672">=</span>socket<span style="color:#f92672">.</span>SOCK_STREAM):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>addr <span style="color:#f92672">=</span> addr
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>proto <span style="color:#f92672">=</span> proto
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>IP <span style="color:#f92672">=</span> ip
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>PORT <span style="color:#f92672">=</span> port
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>endpoints <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>server <span style="color:#f92672">=</span> socket<span style="color:#f92672">.</span>socket(self<span style="color:#f92672">.</span>addr, self<span style="color:#f92672">.</span>proto)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">handle_client</span>(self, conn):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Read headers first</span>
</span></span><span style="display:flex;"><span>            data <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n\r\n</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> data:
</span></span><span style="display:flex;"><span>                chunk <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> chunk:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>                data <span style="color:#f92672">+=</span> chunk
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> data:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Split headers and potential body</span>
</span></span><span style="display:flex;"><span>            headers_end <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>find(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n\r\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            headers_part <span style="color:#f92672">=</span> data[:headers_end]
</span></span><span style="display:flex;"><span>            body_data <span style="color:#f92672">=</span> data[headers_end <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>:]
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Parse headers to get Content-Length if present</span>
</span></span><span style="display:flex;"><span>            headers <span style="color:#f92672">=</span> headers_part<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>            content_length <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> header <span style="color:#f92672">in</span> headers:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> header<span style="color:#f92672">.</span>lower()<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#39;content-length:&#39;</span>):
</span></span><span style="display:flex;"><span>                    content_length <span style="color:#f92672">=</span> int(header<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;:&#39;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>strip())
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Read remaining body data if Content-Length is specified</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> len(body_data) <span style="color:#f92672">&lt;</span> content_length:
</span></span><span style="display:flex;"><span>                chunk <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> chunk:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>                body_data <span style="color:#f92672">+=</span> chunk
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Reconstruct full request</span>
</span></span><span style="display:flex;"><span>            full_request <span style="color:#f92672">=</span> headers_part <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n\r\n</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span> body_data
</span></span><span style="display:flex;"><span>            request <span style="color:#f92672">=</span> full_request<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            response_sent <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> endpoint_key, handler <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>endpoints<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> request<span style="color:#f92672">.</span>startswith(endpoint_key):
</span></span><span style="display:flex;"><span>                    response <span style="color:#f92672">=</span> handler(request)
</span></span><span style="display:flex;"><span>                    conn<span style="color:#f92672">.</span>send(self<span style="color:#f92672">.</span>create_http_response(response)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>                    response_sent <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> response_sent:
</span></span><span style="display:flex;"><span>                response <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;status&#34;</span>: <span style="color:#ae81ff">404</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;status_info&#34;</span>: <span style="color:#e6db74">&#34;Not Found&#34;</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;headers&#34;</span>: {<span style="color:#e6db74">&#39;Content-Type&#39;</span>: <span style="color:#e6db74">&#39;text/plain&#39;</span>, <span style="color:#e6db74">&#39;Content-Length&#39;</span>: <span style="color:#e6db74">&#39;9&#39;</span>},
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;body&#34;</span>: <span style="color:#e6db74">&#34;Not Found&#34;</span>
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                conn<span style="color:#f92672">.</span>send(self<span style="color:#f92672">.</span>create_http_response(response)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Error handling client: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                error_response <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;status&#34;</span>: <span style="color:#ae81ff">500</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;status_info&#34;</span>: <span style="color:#e6db74">&#34;Internal Server Error&#34;</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;headers&#34;</span>: {<span style="color:#e6db74">&#39;Content-Type&#39;</span>: <span style="color:#e6db74">&#39;text/plain&#39;</span>, <span style="color:#e6db74">&#39;Content-Length&#39;</span>: <span style="color:#e6db74">&#39;21&#39;</span>},
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;body&#34;</span>: <span style="color:#e6db74">&#34;Internal Server Error&#34;</span>
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                conn<span style="color:#f92672">.</span>send(self<span style="color:#f92672">.</span>create_http_response(error_response)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_endpoint</span>(self, path, method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;GET&#34;</span>, handler<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        key <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>method<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">{</span>path<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>endpoints[key] <span style="color:#f92672">=</span> handler
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">start_server</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">with</span> self<span style="color:#f92672">.</span>server:
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>server<span style="color:#f92672">.</span>bind((self<span style="color:#f92672">.</span>IP, self<span style="color:#f92672">.</span>PORT))
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>server<span style="color:#f92672">.</span>listen()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>                    conn, addr <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>server<span style="color:#f92672">.</span>accept()
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">with</span> conn:
</span></span><span style="display:flex;"><span>                        self<span style="color:#f92672">.</span>handle_client(conn)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Server could not be started </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_http_response</span>(self, msg):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        msg = {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            status: int,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            status_info: str, 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            headers: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            body: str
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        status <span style="color:#f92672">=</span> msg[<span style="color:#e6db74">&#39;status&#39;</span>]
</span></span><span style="display:flex;"><span>        status_info <span style="color:#f92672">=</span> msg[<span style="color:#e6db74">&#39;status_info&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">+=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;HTTP/1.1 </span><span style="color:#e6db74">{</span>status<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">{</span>status_info<span style="color:#e6db74">}</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> header <span style="color:#f92672">in</span> msg[<span style="color:#e6db74">&#39;headers&#39;</span>]<span style="color:#f92672">.</span>keys():
</span></span><span style="display:flex;"><span>            response <span style="color:#f92672">+=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>header<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>msg[<span style="color:#e6db74">&#39;headers&#39;</span>][header]<span style="color:#e6db74">}</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Blank line between header and body </span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">+=</span> msg[<span style="color:#e6db74">&#39;body&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> response
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ... (the Server class ends here)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Define endpoint handlers outside the Server class</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">echoHandler</span>(request):
</span></span><span style="display:flex;"><span>    echo_str <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34; &#34;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>    msg <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;status&#34;</span>: <span style="color:#ae81ff">200</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;status_info&#34;</span>: <span style="color:#e6db74">&#34;OK&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;headers&#34;</span>: {<span style="color:#e6db74">&#39;Content-Length&#39;</span>: str(len(echo_str<span style="color:#f92672">.</span>encode())), <span style="color:#e6db74">&#39;Content-Type&#39;</span>: <span style="color:#e6db74">&#34;text/plain&#34;</span>},
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;body&#34;</span>: echo_str
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> msg
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    server <span style="color:#f92672">=</span> Server(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>, <span style="color:#ae81ff">40000</span>)
</span></span><span style="display:flex;"><span>    server<span style="color:#f92672">.</span>add_endpoint(<span style="color:#e6db74">&#34;/echo/&#34;</span>, handler<span style="color:#f92672">=</span>echoHandler)
</span></span><span style="display:flex;"><span>    server<span style="color:#f92672">.</span>start_server()
</span></span></code></pre></div><p>In the next part we will try to upgrade our server such that it can handle multiple concurrent connections.</p>

    </div>
</div>

            </main>
        </div>


        <footer class="footer">
    
        <span>
             2025 0x3nigma, Built with
            <a href="https://gohugo.io" class="footerLink">Hugo</a> and
            <a href="https://github.com/LordMathis/hugo-theme-nightfall" class="footerLink">Nightfall</a> theme
        </span>
    
</footer>
    </div>

</body>

</html>
